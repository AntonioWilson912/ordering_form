{% extends 'base.html' %}
{% load static %}
{% block content %}
    <div class="auth-container">
        <div class="auth-card">
            <h2>Set New Password</h2>
            {% if valid %}
                <div class="info-message">
                    <p>This link will expire in {{ expiry_minutes }} minutes.</p>
                </div>
                <form method="post" id="resetForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="id_password1">New Password:</label>
                        <input type="password"
                               name="password1"
                               id="id_password1"
                               class="form-control"
                               required
                               autofocus
                               minlength="8">
                        <small class="form-text">Minimum 8 characters</small>
                    </div>
                    <div class="form-group">
                        <label for="id_password2">Confirm New Password:</label>
                        <input type="password"
                               name="password2"
                               id="id_password2"
                               class="form-control"
                               required
                               minlength="8">
                    </div>
                    {% if errors %}
                        <div class="form-errors">
                            {% for error in errors %}<div class="form-error">{{ error }}</div>{% endfor %}
                        </div>
                    {% endif %}
                    <div class="form-submit">
                        <button type="submit" class="btn btn-blue">Reset Password</button>
                    </div>
                </form>
            {% else %}
                <div class="error-message">
                    <p>This password reset link is invalid or has expired.</p>
                    <a href="{% url 'users:reset' %}" class="btn btn-blue">Request New Link</a>
                </div>
            {% endif %}
            <div class="auth-links">
                <p>
                    Remember your password? <a href="{% url 'users:login' %}">Login</a>
                </p>
            </div>
        </div>
    </div>
{% endblock %}
{% block extra_css %}
    <style>
    .info-message {
        background-color: #e8f4fd;
        border-left: 4px solid #5b83ad;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 4px;
    }
    .info-message p {
        margin: 0;
        color: #5b83ad;
    }
    .error-message {
        text-align: center;
        padding: 20px;
    }
    .error-message p {
        color: #dc3545;
        margin-bottom: 20px;
    }
    </style>
{% endblock %}
{% block extra_js %}
    {% if auto_show_form %}
        <script>
    // Auto-focus on password field if within same browser context
    document.addEventListener('DOMContentLoaded', function() {
        const passwordField = document.getElementById('id_password1');
        if (passwordField) {
            passwordField.focus();
        }
    });
        </script>
    {% endif %}
{% endblock %}
